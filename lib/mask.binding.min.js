(function(t,n){"use strict";function e(t,n){for(var e=0,i=n.length-1;i>e;e++){var r=n.shift();null==t[r]&&(t[r]={}),t=t[r]}return t}function i(t,n){if(null==n)return t;null==t&&(t={});for(var e in n)t[e]=n[e];return t}function r(t,n){for(var e=n.split("."),i=e.length,r=0;i>r;r++){if(null==t)return null;t=t[e[r]]}return t}function o(t,n,e){for(var i=n.split("."),r=i.length,o=0,s=null;r-1>o;o++)s=i[o],null==t[s]&&(t[s]={}),t=t[s];t[i[o]]=e}function s(t,n,i){if(null==t.__observers&&Object.defineProperty(t,"__observers",{value:{},enumerable:!1}),t.__observers[n])return t.__observers[n].push(i),void 0;var r=t.__observers[n]=[i],o=n.split("."),s=o.length>1?e(t,o):t,a=o[0],l=s[a];Object.defineProperty(s,a,{get:function(){return l},set:function(t){l=t;for(var n=0,e=r.length;e>n;n++)r[n](t)}})}function a(t,n){function e(e){t[e]=function(){Array.prototype[e].apply(this,arguments),n(this,e,arguments)}}Object.defineProperty(t,"hasObserver",{value:!0,enumerable:!1,writable:!1});for(var i=0,r=["push","unshift","splice","pop","shift","reverse","sort"],o=r.length;o>i;i++)e(r[i])}function l(t,n,e){return"function"==typeof p?(p(t).on(n,e),void 0):null!=t.addEventListener?(t.addEventListener(n,e,!1),void 0):(t.attachEvent&&t.attachEvent("on"+n,e),void 0)}function u(){}function d(){}function h(t,n,e,r){if(this.constructor===h){var o=e.attr.bindingProvider||n.tagName.toLowerCase();if(m[o]instanceof Function)return new m[o](t,n,e);i(this,m[o])}return null==r&&(r=":bind"===e.compoName?"single":"dual"),this.node=e,this.model=t,this.element=n,this.property=e.attr.property||("single"===r?"element.innerHTML":"element.value"),this.setter=e.attr.setter,this.getter=e.attr.getter,this.dismiss=0,s(t,e.attr.value,this.objectChanged.bind(this)),"single"!==r&&l(n,e.attr.changeEvent||"change",this.domChanged.bind(this)),this.objectChanged(),this}function c(){}function f(){}function v(t,n){if(null==n&&(n=[]),null==t.components)return n;for(var e,i=t.components,r=0,o=i.length;o>r;r++)e=i[r],"validate"!==e.compoName?v(e):n.push(e);return n}function g(t,n){if(null==t)return null;if(null!=t.slots&&t.slots[n]!==void 0){var e=t.slots[n];return"string"==typeof e&&(e=t[e]),"function"!=typeof e&&console.error("Controller defines slot, but that is not a function",t,n),e.bind(t)}return g(t.parent,n)}var p=window.jQuery||window.Zepto||window.$;null==p&&console.warn("Without jQuery/Zepto etc. binder is limited (mouse dom event bindings)"),n.registerHandler(":visible",u),u.prototype={constructor:u,refresh:function(t,e){e.style.display=n.Utils.Condition.isCondition(this.attr.check,t)?"":"none"},renderStart:function(t,n,e){this.refresh(t,e),this.attr.bind&&s(t,this.attr.bind,this.refresh.bind(this,t,e))}},n.registerHandler(":bind",d),d.prototype.renderStart=function(t,n,e){new h(t,e,this,"single")},n.registerUtility("bind",function(t,n,e,i,o,a,l){var u=r(n,t);switch(a){case"node":var d=document.createTextNode(u);return s(n,t,function(t){d.textContent=t}),d;case"attr":return s(n,t,function(t){var n=i.getAttribute(l);i.setAttribute(l,n?n.replace(u,t):t),u=t}),u}return console.error("Unknown binding type",arguments),"Unknown"});var m={};n.registerBinding=function(t,n){m[t]=n},n.BindingProvider=h,h.prototype={constructor:h,objectChanged:function(t){this.dismiss-->0||(null==t&&(t=this.objectWay.get(this.model,this.node.attr.value)),this.domWay.set(this,t),t instanceof Array&&t.hasObserver!==!0&&a(t,this.objectChanged.bind(this)))},domChanged:function(){var t=this.domWay.get(this);if(this.node.validations)for(var n,e=0,i=this.node.validations.length;i>e;e++)if(n=this.node.validations[e],n.validate(t,this.element,this.objectChanged.bind(this))===!1)return;this.dismiss=1,this.objectWay.set(this.model,this.node.attr.value,t),this.dismiss=0},objectWay:{get:function(t,e){return":"===e[0]?n.Utils.ConditionUtil.condition(e.substring(1)):r(t,e)},set:function(t,n,e){o(t,n,e)}},domWay:{get:function(t){if(t.getter){var n=t.node.parent;return null==n||"function"!=typeof n[t.getter]?(console.error("Mask.bindings: Getter should be a function",t.getter,t),null):n[t.getter]()}return r(t,t.property)},set:function(t,n){if(t.setter){var e=t.node.parent;if(null==e||"function"!=typeof e[t.setter])return console.error("Mask.bindings: Getter should be a function",t.getter,t),void 0;e[t.setter](n)}else o(t,t.property,n)}}},n.registerHandler(":dualbind",c),c.prototype.renderEnd=function(t,n,e,i){if(this.components)for(var r,o=0,s=this.components.length;s>o;o++)r=this.components[o],":validate"===r.compoName&&(this.validations||(this.validations=[])).push(r);new h(n,i,this)},function(){function t(){}function e(t,n,e){console.warn("Validate Notification:",t,n);var i=p(t).next(".-validate-invalid");0===i.length&&(i=p("<div>").addClass("-validate-invalid").html("<span></span><button>cancel</button>").insertAfter(t)),i.children("button").off().on("click",function(){i.hide(),e&&e()}).end().children("span").text(n).end().show()}function i(t){p(t).next(".-validate-invalid").hide()}n.registerValidator=function(t,n){o[t]=n},n.registerHandler(":validate",t),t.prototype={constructor:t,renderStart:function(t,n,e){this.element=e,this.model=t},validate:function(t,n,o){null==n&&(n=this.element),this.attr.getter&&(t=r({node:this,element:n},this.attr.getter)),null==this.validators&&this.initValidators();for(var s,a=0,l=this.validators.length;l>a;a++)if(s=this.validators[a],s.validate(this,t)===!1)return e(n,this.message,o),!1;return i(n),!0},initValidators:function(){this.validators=[],this.message=this.attr.message,delete this.attr.message;for(var t in this.attr)if(t in o!=!1){var n=o[t];"function"==typeof n&&(n=new n(this)),this.validators.push(n)}else console.error("Unknown Validator:",t,this)}};var o={match:{validate:function(t,n){return RegExp(t.attr.match).test(n)}},unmatch:{validate:function(t,n){return!RegExp(t.attr.unmatch).test(n)}},minLength:{validate:function(t,n){return n.length>=parseInt(t.attr.minLength,10)}},maxLength:{validate:function(t,n){return n.length<=parseInt(t.attr.maxLength,10)}}}}(),n.registerHandler(":validate:group",f),f.prototype={constructor:f,validate:function(){for(var t,n=v(this),e=0,i=n.length;i>e;e++)if(t=n[e],!t.validate())return!1;return!0}},n.registerAttrHandler("x-signal",function(t,n,e,i,r,o){for(var s,a=n.split(";"),u=0,d=a.length;d>u;u++){s=a[u];var h=s.substring(0,s.indexOf(":")),c=s.substring(s.indexOf(":")+1).trim(),f=g(o,c);f&&l(r,h,f),!f&&console.warn("No slot found for signal",c,o)}})})("undefined"==typeof window?global:window,"undefined"==typeof mask?null:mask);